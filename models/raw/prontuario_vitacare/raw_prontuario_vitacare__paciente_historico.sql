{{
    config(
        alias="paciente_historico",
        materialized="table",
    )
}}

select
    safe_cast(N_CPF as string) as n_cpf,
    safe_cast(N_DNV as string) as n_dnv,
    safe_cast(NIS as string) as nis,
    safe_cast(N_CNS_DA_PESSOA_CADASTRADA as string) as n_cns_da_pessoa_cadastrada,
    safe_cast(N_DA_FAMILIA as string) as n_da_familia,
    safe_cast(N_DO_PRONTUARIO as string) as n_do_prontuario,
    safe_cast(AP as string) as ap,
    safe_cast(NUMERO_CNES_UNIDADE as string) as numero_cnes_unidade,
    safe_cast(NOME_UNIDADE_DE_SAUDE as string) as nome_unidade_de_saude,
    safe_cast(NOME_EQUIPE_DE_SAUDE as string) as nome_equipe_de_saude,
    safe_cast(CODIGO_DA_EQUIPE_DE_SAUDE as string) as codigo_da_equipe_de_saude,
    safe_cast(CODIGO_INE_EQUIPE_DE_SAUDE as string) as codigo_ine_equipe_de_saude,
    safe_cast(CODIGO_MICROAREA as string) as codigo_microarea,
    safe_cast(NOME_ACS as string) as nome_acs,
    safe_cast(NOME_DA_PESSOA_CADASTRADA as string) as nome_da_pessoa_cadastrada,
    safe_cast(NOME_SOCIAL_DA_PESSOA_CADASTRADA as string) as nome_social_da_pessoa_cadastrada,
    safe_cast(NOME_DA_MAE_PESSOA_CADASTRADA as string) as nome_da_mae_pessoa_cadastrada,
    safe_cast(DATA_CADASTRO as string) as data_cadastro,
    safe_cast(DATA_ULTIMA_ATUALIZACAO_DO_CADASTRO as string) as data_ultima_atualizacao_do_cadastro,
    safe_cast(SITUACAO_USUARIO as string) as situacao_usuario,
    safe_cast(OBITO as string) as obito,
    safe_cast(SEXO as string) as sexo,
    safe_cast(ORIENTACAO_SEXUAL as string) as orientacao_sexual,
    safe_cast(IDENTIDADE_GENERO as string) as identidade_genero,
    safe_cast(RACA_COR as string) as raca_cor,
    safe_cast(DATA_DE_NASCIMENTO as string) as data_de_nascimento,
    safe_cast(SITUACAO_PROFISSIONAL as string) as situacao_profissional,
    safe_cast(OCUPACAO as string) as ocupacao,
    safe_cast(NACIONALIDADE as string) as nacionalidade,
    safe_cast(PAIS_DE_NASCIMENTO as string) as pais_de_nascimento,
    safe_cast(MUNICIPIO_DE_NASCIMENTO as string) as municipio_de_nascimento,
    safe_cast(ALCOOLISMO as string) as alcoolismo,
    safe_cast(DOENCA_DE_CHAGAS as string) as doenca_de_chagas,
    safe_cast(DEFICIENCIA_FISICA as string) as deficiencia_fisica,
    safe_cast(DOENCA_MENTAL as string) as doenca_mental,
    safe_cast(EPILEPSIA as string) as epilepsia,
    safe_cast(DIABETES as string) as diabetes,
    safe_cast(GESTANTE as string) as gestante,
    safe_cast(HANSENIASE as string) as hanseniase,
    safe_cast(HIPERTENSAO_ARTERIAL as string) as hipertensao_arterial,
    safe_cast(MALARIA as string) as malaria,
    safe_cast(TUBERCULOSE as string) as tuberculose,
    safe_cast(TABAGISMO as string) as tabagismo,
    safe_cast(FREQUENTA_ESCOLA as string) as frequenta_escola,
    safe_cast(TIPO_DE_LOGRADOURO as string) as tipo_de_logradouro,
    safe_cast(LOGRADOURO as string) as logradouro,
    safe_cast(CEP_LOGRADOURO as string) as cep_logradouro,
    safe_cast(BAIRRO_DE_MORADIA as string) as bairro_de_moradia,
    safe_cast(COMUNIDADE_MORADIA as string) as comunidade_moradia,
    safe_cast(COMUNIDADE_TRADICIONAIS as string) as comunidade_tradicionais,
    safe_cast(TELEFONE_CONTATO as string) as telefone_contato,
    safe_cast(EMAIL_CONTATO as string) as email_contato,
    safe_cast(TIPO_DE_DOMICILIO as string) as tipo_de_domicilio,
    safe_cast(EXISTENCIA_DE_ENERGIA_ELETRICA as string) as existencia_de_energia_eletrica,
    safe_cast(DESTINO_DO_LIXO as string) as destino_do_lixo,
    safe_cast(ABASTECIMENTO_DE_AGUA as string) as abastecimento_de_agua,
    safe_cast(TRATAMENTO_DE_AGUA as string) as tratamento_de_agua,
    safe_cast(POSSUI_FILTRO_AGUA as string) as possui_filtro_agua,
    safe_cast(ESGOTAMENTO_SANITARIO as string) as esgotamento_sanitario,
    safe_cast(POSSUI_PLANO_DE_SAUDE as string) as possui_plano_de_saude,
    safe_cast(EM_CASO_DE_DOENCA_PROCURA as string) as em_caso_de_doenca_procura,
    safe_cast(CULTIVA_PLANTAS_MEDICINAIS as string) as cultiva_plantas_medicinais,
    safe_cast(USA_PLANTAS_MEDICINAIS as string) as usa_plantas_medicinais,
    safe_cast(TEM_ANIMAIS_NO_DOMICILIO as string) as tem_animais_no_domicilio,
    safe_cast(QUAL_IS_ as string) as qual_is,
    safe_cast(JA_SOFREU_ATAQUE_DE_MORCEGO as string) as ja_sofreu_ataque_de_morcego,
    safe_cast(MEIOS_DE_COMUNICACAO_QUE_UTILIZA as string) as meios_de_comunicacao_que_utiliza,
    safe_cast(MEIOS_DE_TRANSPORTE_QUE_UTILIZA as string) as meios_de_transporte_que_utiliza,
    safe_cast(PARTICIPACAO_EM_GRUPOS_COMUNITARIOS as string) as participacao_em_grupos_comunitarios,
    safe_cast(RENDA_FAMILIAR as string) as renda_familiar,
    safe_cast(VUNERABILIDADE_SOCIAL as string) as vulnerabilidade_social,
    safe_cast(FAMILIA_BENEFICIARIA_AUXILIO_BRASIL as string) as familia_beneficiaria_auxilio_brasil,
    safe_cast(FAMILIA_BENEFICIARIA_CFC as string) as familia_beneficiaria_cfc,
    safe_cast(N_DE_CONSULTAS_2023 as string) as n_de_consultas_2023,
    safe_cast(N_DE_PROCEDIMENTOS_2023 as string) as n_de_procedimentos_2023,
    safe_cast(N_DE_CONSULTAS_2022 as string) as n_de_consultas_2022,
    safe_cast(N_DE_PROCEDIMENTOS_2022 as string) as n_de_procedimentos_2022,
    safe_cast(N_DE_CONSULTAS_2021 as string) as n_de_consultas_2021,
    safe_cast(N_DE_PROCEDIMENTOS_2021 as string) as n_de_procedimentos_2021,
    safe_cast(N_DE_CONSULTAS_2020 as string) as n_de_consultas_2020,
    safe_cast(N_DE_PROCEDIMENTOS_2020 as string) as n_de_procedimentos_2020,
    safe_cast(N_DE_CONSULTAS_2019 as string) as n_de_consultas_2019,
    safe_cast(N_DE_PROCEDIMENTOS_2019 as string) as n_de_procedimentos_2019,
    safe_cast(N_DE_CONSULTAS_2018 as string) as n_de_consultas_2018,
    safe_cast(N_DE_PROCEDIMENTOS_2018 as string) as n_de_procedimentos_2018,
    safe_cast(DATA_1A_CONSULTA as string) as data_1a_consulta,
    safe_cast(DATA_2A_CONSULTA as string) as data_2a_consulta,
    safe_cast(DATA_DA_ULTIMA_CONSULTA as string) as data_da_ultima_consulta,
    safe_cast(DATA_DA_ULTIMA_CONSULTA_MED_ENF_PROPRIA_EQUIPE as string) as data_da_ultima_consulta_med_enf_propria_equipe,
    safe_cast(HIST_CID as string) as hist_cid,
    safe_cast(DATA_REGISTRO_CID_01 as string) as data_registro_cid_01,
    safe_cast(CID_01 as string) as cid_01,
    safe_cast(DATA_REGISTRO_CID_02 as string) as data_registro_cid_02,
    safe_cast(CID_02 as string) as cid_02,
    safe_cast(DATA_REGISTRO_CID_03 as string) as data_registro_cid_03,
    safe_cast(CID_03 as string) as cid_03,
    safe_cast(DATA_REGISTRO_CID_04 as string) as data_registro_cid_04,
    safe_cast(CID_04 as string) as cid_04,
    safe_cast(DATA_REGISTRO_CID_05 as string) as data_registro_cid_05,
    safe_cast(CID_05 as string) as cid_05,
    safe_cast(DATA_REGISTRO_CID_06 as string) as data_registro_cid_06,
    safe_cast(CID_06 as string) as cid_06,
    safe_cast(DATA_REGISTRO_CID_07 as string) as data_registro_cid_07,
    safe_cast(CID_07 as string) as cid_07,
    safe_cast(DATA_REGISTRO_CID_08 as string) as data_registro_cid_08,
    safe_cast(CID_08 as string) as cid_08,
    safe_cast(DATA_REGISTRO_CID_09 as string) as data_registro_cid_09,
    safe_cast(CID_09 as string) as cid_09,
    safe_cast(DATA_REGISTRO_CID_10 as string) as data_registro_cid_10,
    safe_cast(CID_10 as string) as cid_10,
    safe_cast(PRIMEIRO_CID_EXTRA_POR_CAMPO as string) as primeiro_cid_extra_por_campo,
    safe_cast(DATA_REGISTRO_CID_EXTRA_01 as string) as data_registro_cid_extra_01,
    safe_cast(SEGUNDO_CID_EXTRA_POR_CAMPO as string) as segundo_cid_extra_por_campo,
    safe_cast(DATA_REGISTRO_CID_EXTRA_02 as string) as data_registro_cid_extra_02,
    safe_cast(PESO as string) as peso,
    safe_cast(ALTURA as string) as altura,
    safe_cast(DATA_REGISTRO_PESO_ALTURA as string) as data_registro_peso_altura,
    safe_cast(DATA_ULTIMA_MENSTRUACAO as string) as data_ultima_menstruacao,
    safe_cast(PACIENTE_TEMPORARIO as string) as paciente_temporario,
    safe_cast(PACIENTE_SITUACAO_RUA as string) as paciente_situacao_rua,
    safe_cast(SITUACAO_RUA_TEMPO_SITUACAO as string) as situacao_rua_tempo_situacao,
    safe_cast(LOCAL_REALIZACAO_CADASTRAMENTO as string) as local_realizacao_cadastramento,
    safe_cast(LOCAL_PERMANENCIA_PERIODO_DIURNO as string) as local_permanencia_periodo_diurno,
    safe_cast(LOCAL_PERMANENCIA_PERIODO_NOTURNO as string) as local_permanencia_periodo_noturno,
    safe_cast(RECEBE_ALGUM_BENEFICIO as string) as recebe_algum_beneficio,
    safe_cast(POSSUI_REFERENCIA_FAMILIAR as string) as possui_referencia_familiar,
    safe_cast(VISITA_ALGUM_FAMILIAR_COM_FREQUENCIA as string) as visita_algum_familiar_com_frequencia,
    safe_cast(QUANTAS_VEZES_SE_ALIMENTA_POR_DIA as string) as quantas_vezes_se_alimenta_por_dia,
    safe_cast(QUAL_A_ORIGEM_DA_ALIMENTACAO as string) as qual_a_origem_da_alimentacao,
    safe_cast(TEM_ACESSO_A_HIGIENE_PESSOAL as string) as tem_acesso_a_higiene_pessoal,
    safe_cast(FAZ_TRATAMENTO_EM_ALGUM_LUGAR as string) as faz_tratamento_em_algum_lugar,
    safe_cast(TEM_ALGUMA_DOENCA as string) as tem_alguma_doenca,
    safe_cast(APRESENTA_TOSSE as string) as apresenta_tosse,
    safe_cast(APRESENTA_MANCHAS_NO_CORPO as string) as apresenta_manchas_no_corpo,
    safe_cast(APRESENTA_FERIDAS_NO_CORPO as string) as apresenta_feridas_no_corpo,
    safe_cast(USA_ALGUMA_MEDICACAO as string) as usa_alguma_medicacao,
    safe_cast(FAZ_USO_DE_DROGAS as string) as faz_uso_de_drogas,
    safe_cast(JA_FOI_INTERNADO as string) as ja_foi_internado,
    safe_cast(INFORMACOES_COMPLEMENTARES as string) as informacoes_complementares,
    safe_cast(SITUACAO_MORADIA_POSSE as string) as situacao_moradia_posse,
    safe_cast(NOME_INSTITUICAO as string) as nome_instituicao,
    safe_cast(INSTITUICAO_PUBLICA_PRIVADA as string) as instituicao_publica_privada,
    safe_cast(POSSUI_PROF_SAUDE as string) as possui_prof_saude,
    safe_cast(TIPO_UNIDADE_PERMANENCIA as string) as tipo_unidade_permanencia,
    safe_cast(FAMILIA_LOCALIZACAO as string) as familia_localizacao,
    safe_cast(TEMPO_MORADIA as string) as tempo_moradia,
    safe_cast(COMODOS as string) as comodos,
    safe_cast(SITUACAO_FAMILIAR as string) as situacao_familiar,
    safe_cast(ESCOLARIDADE as string) as escolaridade,
    safe_cast(TERRITORIO_SOCIAL as string) as territorio_social,
    safe_cast(RELIGIAO as string) as religiao,
    safe_cast(CERTIDAO_NASCIMENTO as string) as certidao_nascimento,
    safe_cast(CRIANCA_MAT_CRECHE_OU_PRE_ESCOLA as string) as crianca_mat_creche_ou_pre_escola,
    safe_cast(RESPONSAVEL as string) as responsavel,
    safe_cast(RELACAO_PARENTESCO_RESPONSAVEL as string) as relacao_parentesco_responsavel,
    safe_cast(FUMANTE as string) as fumante,
    safe_cast(FUMANTE_TEMPO as string) as fumante_tempo,
    safe_cast(FUMANTE_QUANT as string) as fumante_quant,

    -- Metadata columns
    safe_cast(updated_at as string) as updated_at
from {{ source("brutos_prontuario_vitacare_staging", "paciente_historico_eventos") }}
